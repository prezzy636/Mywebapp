<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>textdrai - Your AI Companion</title>

    <!-- Main stylesheet -->
    <link rel="stylesheet" href="style.css">

    <!-- Font Awesome icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">

    <!-- highlight.js theme -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">

    <!-- DOMPurify (sanitize HTML from marked) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dompurify/2.4.0/purify.min.js"></script>

    <!-- marked (Markdown parser) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

</head>
<body>

    <div id="top-loader"></div>

    <!-- Authentication Section -->
    <div id="auth-container" class="auth-container">
        <div class="auth-box">
            <div id="login-view">
                <h3>Sign in to textdrai</h3>
                <p class="auth-welcome-text">Welcome back! Please sign in to continue.</p>
                <button class="social-login-btn" id="google-signin-button"><i class="fab fa-google"></i> Continue with Google</button>
                <button class="social-login-btn" id="github-signin-button"><i class="fab fa-github"></i> Continue with GitHub</button>
                <div class="separator">or</div>
                <input type="email" id="login-email" placeholder="Email Address">
                <div class="password-wrapper">
                    <input type="password" id="login-password" placeholder="Password">
                    <i class="fas fa-eye password-toggle"></i>
                </div>
                <div id="password-error" aria-live="polite"></div>
                <button id="login-button">Continue</button>
                <p class="auth-switch">Don't have an account? <a href="#" id="show-signup">Sign up</a></p>
            </div>
            <div id="signup-view" class="hidden">
                <h3>Create Your Account</h3>
                <input type="text" id="signup-firstname" placeholder="First Name">
                <input type="text" id="signup-lastname" placeholder="Last Name">
                <input type="email" id="signup-email" placeholder="Email Address">
                <div class="password-wrapper">
                    <input type="password" id="signup-password" placeholder="Create a Password">
                    <i class="fas fa-eye password-toggle"></i>
                </div>
                <div class="password-wrapper">
                    <input type="password" id="signup-confirm-password" placeholder="Confirm Password">
                    <i class="fas fa-eye password-toggle"></i>
                </div>
                <button id="signup-button">Create Account</button>
                <p class="auth-switch">Already have an account? <a href="#" id="show-login">Log in</a></p>
            </div>
        </div>
    </div>

    <!-- Main Chat Application -->
    <div id="app-container" class="app-container hidden">
        <aside id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="branding-wrapper">
                    <h3>textdrai</h3>
                    <!-- THIS LINE IS CHANGED -->
                    <img src="logo.png" id="header-icon" alt="App Icon">
                </div>
                <button id="new-chat-button" class="new-chat-btn"><i class="fas fa-plus"></i> New Chat</button>
            </div>
            <div class="previous-chats">
                <h4>Previous Chats</h4>
                <ul id="chat-history-list"></ul>
            </div>
            <div class="models-section">
                <h4>Available Models</h4>
                <select id="model-selector"></select>
            </div>
             <div class="user-profile">
                <div id="profile-picture" class="profile-picture" aria-hidden="true"></div>
                <span id="user-email-display"></span>
                <button id="logout-button" title="Logout"><i class="fas fa-sign-out-alt"></i></button>
            </div>
        </aside>

        <main class="chat-area">
            <button id="menu-toggle" class="menu-toggle"><i class="fas fa-bars"></i></button>

            <!-- Chat input at the top -->
            <div class="chat-input-area">
                <div id="image-preview-container" class="image-preview-container hidden"></div>

                <div class="input-wrapper">
                    <textarea id="user-input" placeholder="Ask me anything..." rows="1" aria-label="Message input"></textarea>
                    <button id="image-upload-button" class="icon-button" title="Upload Image"><i class="fas fa-paperclip"></i></button>
                    <input type="file" id="image-upload-input" hidden accept="image/*" multiple>
                    <button id="speech-to-text-button" class="icon-button" title="Voice to Text"><i class="fas fa-microphone"></i></button>
                    <button id="send-button" class="icon-button" title="Send Message"><i class="fas fa-paper-plane"></i></button>
                </div>
            </div>
            
            <!-- Chat messages container -->
            <div id="chat-messages" class="chat-messages" role="log" aria-live="polite"></div>

        </main>
    </div>

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <!-- Main script -->
    <script src="script.js"></script>
    
    <!-- Initialize highlight.js -->
    <script>
      document.addEventListener('DOMContentLoaded', () => {
        if (window.hljs) {
          window.hljs.configure({ ignoreUnescapedHTML: true });
          document.querySelectorAll('pre code').forEach((block) => window.hljs.highlightElement(block));
        }
      });
    </script>

</body>
</html>